#include <iostream>
using namespace std;

// Структура за свързана опашка
// Опашката може да се разглежда като структура от данни, която поддържа елементи в ред на добавяне (FIFO).
struct pq {
	int i;       // Стойност на елемент в опашката
	pq* next;    // Указател към следващия елемент
};

// Функция за добавяне на елемент в края на опашката
void pushq(pq*& top, pq*& bottom, int x) {
	pq* p = new(pq);   // Създаване на нов елемент
	p->i = x;          // Записване на стойността в новия елемент
	p->next = NULL;    // Следващият елемент е NULL, защото е последен в момента

	if (top == NULL)   // Проверка дали опашката е празна
		top = p;       // Ако е празна, новият елемент става начало
	else
		bottom->next = p; // Ако не е празна, свързва стария последен елемент с новия

	bottom = p;        // Обновяване на указателя към последния елемент (bottom)
}

// Функция за извличане на елемент от началото на опашката
int popq(pq*& top, pq*& bottom) {
	if (top == NULL) {   // Проверка дали опашката е празна
		cout << "Queue is empty" << endl;
		return -1;       // Връщане на специална стойност, когато няма елементи
	}

	int value = top->i;  // Съхраняване на стойността на първия елемент
	pq* p = top;         // Указател към текущия начален елемент
	top = top->next;     // Пренасочване на указателя top към следващия елемент
	delete p;            // Освобождаване на паметта на стария начален елемент

	if (top == NULL)     // Ако след изтриването няма повече елементи
		bottom = NULL;   // Обновяване на указателя bottom на NULL

	return value;        // Връщане на извлечената стойност
}

int main() {
	int n, i, a;
	pq* top = NULL;      // Начало на опашката (указва към първия елемент)
	pq* bottom = NULL;   // Край на опашката (указва към последния елемент)

	cout << "Enter the number of elements to add to the queue: ";
	cin >> n;

	// Добавяне на елементи в опашката
	for (i = 1; i <= n; i++) {
		cout << "Enter element " << i << ": ";
		cin >> a;
		pushq(top, bottom, a); // Използване на pushq за добавяне на елементи
	}

	cout << "Queue elements after insertion:" << endl;

	// Извличане и отпечатване на елементи от опашката
	for (i = 1; i <= n; i++) {
		int value = popq(top, bottom); // Използване на popq за извличане на елементи
		if (value != -1)   // Проверка дали извличането е успешно
			cout << value << endl; // Отпечатване на стойността на елемента
	}

	return 0;
}
