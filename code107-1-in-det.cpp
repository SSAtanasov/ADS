#include <iostream>
using namespace std;

// Дефиниране на структура на елемент от списъка
struct plist {
	int i;          // Информационна част от тип int
	plist* next;    // Указател към следващия елемент - рекурсивно дефиниране на структурата
};

// Подпрограма за включване на елемент в началото на списък
void insertBegin(plist*& l, int x) {
	plist* p = new plist;  // Създаване на нов елемент. Запазваме памет за "p", което е указател към елемент от списъка.
	p->i = x;              // Задаваме стойност на информационното поле "i" на новия елемент със стойността "x".
	p->next = l;           // Указателят "next" на новия елемент насочваме към стария първи елемент, т.е. "l".
	l = p;                 // Пренасочваме указателя "l" да сочи към новия елемент. Така новият елемент става първи.
}

// Включване на елемент след даден елемент (l) в списък
void insertAfter(plist*& l, int x) {
	if (l == NULL) {
		insertBegin(l, x); // Ако списъкът е празен, добавяме елемент в началото, използвайки insertBegin.
	} else {
		plist* p = new plist;  // Създаваме нов елемент - запазваме памет за "p", което е указател към новия елемент.
		p->i = x;              // Присвояваме стойността "x" на информационното поле на новия елемент.
		p->next = l->next;     // Указателят "next" на новия елемент насочваме към елемента, който е след текущия (l->next).
		l->next = p;           // Насочваме "next" на текущия елемент (l) към новия елемент (p), за да го добавим в списъка.
	}
}

// Включване на елемент преди даден елемент (l) в списък
void insertBefore(plist*& l, int x) {
	if (l == NULL) {
		insertBegin(l, x); // Ако списъкът е празен, добавяме елемент в началото, използвайки insertBegin.
	} else {
		plist* p = new plist;  // Създаваме нов елемент - запазваме памет за "p".
		p->i = l->i;           // Копираме текущата стойност на елемента (l->i) в новия елемент (p->i).
		p->next = l->next;     // Насочваме указателя "next" на новия елемент към следващия елемент (l->next).
		l->i = x;              // Променяме стойността на текущия елемент, като му присвояваме "x".
		l->next = p;           // Насочваме "next" на текущия елемент към новия елемент, за да го добавим в списъка.
	}
}

// Подпрограма за изтриване на елемент с дадена стойност от списък
void deletel(plist*& l, int x) {
	plist* p = l;              // Дефинираме указател "p", който сочи към текущия елемент (l).
	plist* q = NULL;           // Дефинираме указател "q" за елемента, който ще изтрием (първоначално не сочи никъде).

	// Проверка дали първият елемент съдържа стойността "x"
	if (l != NULL && l->i == x) {
		l = l->next;           // Ако да, насочваме "l" към следващия елемент.
		delete p;              // Освобождаваме паметта на първия елемент (p).
	} else {
		// Търсим елемента с цикъл, докато не намерим или края на списъка
		while (p->next != NULL && p->next->i != x) {
			p = p->next;       // Преминаваме към следващия елемент.
		}
		// Ако намерим елемента
		if (p->next != NULL) {
			q = p->next;       // Указателят "q" сочи към елемента за изтриване.
			p->next = p->next->next; // Пропускаме този елемент.
			delete q;          // Освобождаваме паметта на елемента "q".
		}
	}
}

// Подпрограма за търсене на елемент в списъка
plist* search(plist* l, int x) {
	while (l != NULL) {        // Обхождаме списъка, докато не стигнем края (NULL).
		if (l->i == x) {       // Проверяваме дали текущият елемент съдържа търсената стойност.
			return l;          // Ако я съдържа, връщаме указател към този елемент.
		}
		l = l->next;           // Преминаваме към следващия елемент.
	}
	return NULL;               // Ако не намерим елемента, връщаме NULL.
}

// Подпрограма за обхождане и отпечатване на списъка
void printl(plist* l) {
	while (l != NULL) {        // Докато има елементи в списъка
		cout << l->i << endl;  // Отпечатваме стойността на текущия елемент
		l = l->next;           // Преминаваме към следващия елемент
	}
}

// Главна функция
int main() {
	int n, i, a;
	plist* list = NULL;        // Инициализираме празен списък

	cout << "Enter the number of elements: "; // Въвеждаме броя на елементите
	cin >> n;

	// Добавяме елементи в началото на списъка
	for (i = 1; i <= n; i++) {
		cout << "Enter element " << i << ": "; // Въвеждаме стойността на текущия елемент
		cin >> a;
		insertBegin(list, a); // Включваме елемента в началото на списъка
	}

	cout << "Enter the value to search: "; // Подканваме за стойност за търсене
	cin >> a;
	if (search(list, a) != NULL)            // Проверяваме дали елемента съществува
		cout << "Yes" << endl;             // Ако е намерен, изписваме "Yes"
	else
		cout << "No" << endl;              // Ако не е намерен, изписваме "No"

	cout << "List elements:" << endl;
	printl(list); // Отпечатваме всички елементи на списъка

	return 0;
}
